{"version":3,"sources":["webpack:///./node_modules/optinmonster-js-library/src/vue/utils/apiJsScript.js","webpack:///./node_modules/optinmonster-js-library/src/vue/templates/mixins/templatePreviewsSetup.js","webpack:///./src/pages/Playbooks.vue","webpack:///src/pages/Playbooks.vue","webpack:///./src/pages/Playbooks.vue?642f","webpack:///./src/pages/Playbooks.vue?4fcc","webpack:///./src/pages/Playbooks.vue?3190","webpack:///./src/components/mixins/creation.js"],"names":["loadApiScript","scriptId","accountid","userId","script","document","getElementById","head","getElementsByTagName","documentElement","createElement","type","id","src","urls","apiJs","async","dataset","account","user","env","appendChild","templatePreviewsSetup","this","listenApiLoaded","$store","subscribe","mutation","ignore","triggers","shouldClose","startsWith","includes","closeAllPreviews","methods","cb","forEach","evt","setApiLoaded","commit","render","_vm","_c","_self","reachedCampaignLimit","attrs","staticClass","class","previewing","tabs","alerts","length","staticStyle","_e","isLoading","hasRecommendations","staticRenderFns","mixins","computed","unavailableRules","watch","selectedPlaybook","created","dispatch","then","rules","catch","handleUsePlaybook","component","creation","data","templates","name","route","path","params","tab","playbooks"],"mappings":"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","file":"js/playbooks.47b5a2c8.js","sourcesContent":["import { isProduction, isDevelopment, currentEnv } from '../../utils/env';\nimport urls from './urls';\n\nexport const loadApiScript = (scriptId, accountid, userId) => {\n\tlet script = document.getElementById(scriptId);\n\tif (script) {\n\t\treturn script;\n\t}\n\tconst head = document.getElementsByTagName('head')[0] || document.documentElement;\n\tscript = document.createElement('script');\n\tscript.type = 'text/javascript';\n\tscript.id = scriptId;\n\tscript.src = urls.apiJs();\n\tscript.async = true;\n\tscript.dataset.account = accountid;\n\tscript.dataset.user = userId;\n\tif (!isProduction()) {\n\t\tscript.dataset.env = isDevelopment() ? 'dev' : currentEnv;\n\t}\n\n\thead.appendChild(script);\n\n\treturn script;\n};\n","import {\n\tcloseCampaigns,\n\tinitCampaignsDemo,\n\tinitCampaignsWp,\n\tinitCampaignsPreview,\n\tinitCampaignsBgClick,\n\tinitMobilePreview,\n} from 'optinmonster-js-library/src/utils/omapi';\nimport { loadApiScript } from 'optinmonster-js-library/src/vue/utils/apiJsScript';\n\nexport const templatePreviewsSetup = {\n\tcreated() {\n\t\tthis.listenApiLoaded();\n\n\t\t// Ensure campaigns are flagged as demos.\n\t\tinitCampaignsDemo();\n\t\t// Ensure campaigns are flagged as wp.\n\t\tinitCampaignsWp();\n\t\t// Make previews closeable by clicking background.\n\t\tinitCampaignsBgClick();\n\t\t// Disable form fields\n\t\tinitCampaignsPreview();\n\t\t// Handle mobile template previews\n\t\tinitMobilePreview();\n\n\t\tthis.$store.subscribe((mutation) => {\n\t\t\tconst ignore = [\n\t\t\t\t'templates/setLoadingPreview',\n\t\t\t\t'templates/setPreviewing',\n\t\t\t\t'templates/filterOptions',\n\t\t\t\t'templates/templates',\n\t\t\t\t'templates/permittedTypes',\n\t\t\t\t'templates/recentTemplates',\n\t\t\t\t'templates/popular',\n\t\t\t\t'templates/setApiLoaded',\n\t\t\t];\n\t\t\tconst triggers = ['route/ROUTE_CHANGED'];\n\n\t\t\tlet shouldClose = mutation.type.startsWith('templates/') && !ignore.includes(mutation.type);\n\t\t\tif (!shouldClose) {\n\t\t\t\tshouldClose = triggers.includes(mutation.type);\n\t\t\t}\n\n\t\t\tif (shouldClose) {\n\t\t\t\tthis.closeAllPreviews();\n\t\t\t}\n\t\t});\n\t},\n\tbeforeDestroy() {\n\t\tinitCampaignsDemo(false);\n\t\tinitCampaignsWp(false);\n\t\tinitCampaignsPreview(false);\n\t\tinitCampaignsBgClick(false);\n\t\tinitMobilePreview(false);\n\t},\n\tmethods: {\n\t\tlistenApiLoaded(cb = 'addEventListener') {\n\t\t\t['om.Api.init', 'om.Main.init', 'om.Campaigns.init', 'om.Campaign.init'].forEach((evt) =>\n\t\t\t\tdocument[cb](evt, this.setApiLoaded)\n\t\t\t);\n\t\t},\n\t\t/**\n\t\t * Handle finishing the API load.\n\t\t *\n\t\t * Remove the apiLoaded event listener and set the\n\t\t * apiLoaded flag to true once the api has loaded.\n\t\t *\n\t\t * @returns {void}\n\t\t */\n\t\tsetApiLoaded() {\n\t\t\tthis.listenApiLoaded('removeEventListener');\n\t\t\tthis.$store.commit('templates/setApiLoaded');\n\t\t},\n\t\t/**\n\t\t * Handles closing all open campaigns and resetting preview state.\n\t\t *\n\t\t * @returns {void}\n\t\t */\n\t\tcloseAllPreviews() {\n\t\t\tcloseCampaigns();\n\t\t\tthis.$store.commit('templates/setLoadingPreview', '');\n\t\t\tthis.$store.commit('templates/setPreviewing', '');\n\t\t},\n\t\t/**\n\t\t * Handles generating our api script tag.\n\t\t *\n\t\t * @param {string} scriptId The script id.\n\t\t * @param {int} accountid The account id.\n\t\t * @param {int} userId The user id.\n\t\t *\n\t\t * @returns {string} The script tag\n\t\t */\n\t\tloadApiScript(scriptId, accountid, userId) {\n\t\t\treturn loadApiScript(scriptId, accountid, userId);\n\t\t},\n\t},\n};\n","var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.reachedCampaignLimit)?_c('templates-limit-exceeded',{attrs:{\"is-playbooks\":true}}):_c('core-page',[_c('div',{staticClass:\"playbooks-page-wrapper dashboard-wrapper\",class:{ previewing: false }},[_c('common-page-tabnav',{attrs:{\"current\":\"playbooks\",\"tabs\":_vm.tabs}}),(_vm.alerts.length)?_c('div',{staticClass:\"container\",staticStyle:{\"margin\":\"46px auto 40px\"}},[_c('core-alerts',{attrs:{\"alerts\":_vm.alerts}})],1):_vm._e(),_c('div',{staticClass:\"playbooks-content\"},[_c('playbooks-intro'),(_vm.isLoading)?_c('core-loading',{staticClass:\"playbooks-loading\"}):_c('div',[(_vm.hasRecommendations)?_c('playbooks-recommendations'):_vm._e(),_c('playbooks-table')],1)],1),_c('playbooks-upgrade-modal'),_c('campaigns-modal-create-campaign',{attrs:{\"from-playbook\":true}}),_c('templates-modal-not-connected')],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n\t<templates-limit-exceeded v-if=\"reachedCampaignLimit\" :is-playbooks=\"true\" />\n\t<core-page v-else>\n\t\t<div class=\"playbooks-page-wrapper dashboard-wrapper\" :class=\"{ previewing: false }\">\n\t\t\t<common-page-tabnav current=\"playbooks\" :tabs=\"tabs\" />\n\t\t\t<div v-if=\"alerts.length\" class=\"container\" style=\"margin: 46px auto 40px\">\n\t\t\t\t<core-alerts :alerts=\"alerts\" />\n\t\t\t</div>\n\t\t\t<div class=\"playbooks-content\">\n\t\t\t\t<playbooks-intro />\n\t\t\t\t<core-loading v-if=\"isLoading\" class=\"playbooks-loading\" />\n\t\t\t\t<div v-else>\n\t\t\t\t\t<playbooks-recommendations v-if=\"hasRecommendations\" />\n\t\t\t\t\t<playbooks-table />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<playbooks-upgrade-modal />\n\t\t\t<campaigns-modal-create-campaign :from-playbook=\"true\" />\n\t\t\t<templates-modal-not-connected />\n\t\t</div>\n\t</core-page>\n</template>\n\n<script>\nimport { mapState, mapGetters, mapMutations } from 'vuex';\nimport { filtering } from 'optinmonster-js-library/src/vue/playbooks/mixins/filtering';\nimport { rules } from 'optinmonster-js-library/src/vue/playbooks/mixins/rules';\nimport { creation } from '@/components/mixins/creation';\nimport { templatePreviewsSetup } from 'optinmonster-js-library/src/vue/templates/mixins/templatePreviewsSetup';\n\nexport default {\n\tmixins: [filtering, templatePreviewsSetup, creation, rules],\n\tcomputed: {\n\t\t...mapState(['alerts']),\n\t\t...mapState('playbooks', ['playbooks', 'previewing', 'filterOptions', 'selectedPlaybook']),\n\t\t...mapGetters(['connected', 'reachedCampaignLimit']),\n\t\t...mapGetters('playbooks', ['hasRecommendations']),\n\t\t/**\n\t\t * Is Loading\n\t\t *\n\t\t * @returns {boolean} Are playbooks, rules, or filters loading?\n\t\t */\n\t\tisLoading() {\n\t\t\treturn this.$store.getters.isLoading(['playbooks', 'rules', 'filterOptions']);\n\t\t},\n\t\t/**\n\t\t * Get the unavailable rules\n\t\t *\n\t\t * @returns {Array} The array of unavailable rules.\n\t\t */\n\t\tunavailableRules() {\n\t\t\treturn this.selectedPlaybook.rules.filter((rule) => !this.ruleAvailable(rule)) || [];\n\t\t},\n\t},\n\twatch: {\n\t\t/**\n\t\t * Listen for changes to the selected Playbook. This will\n\t\t * then trigger the creation flow.\n\t\t *\n\t\t * @param {Object} playbook The selected Playbook.\n\t\t *\n\t\t * @returns {void}\n\t\t */\n\t\tselectedPlaybook(playbook) {\n\t\t\tif (playbook) {\n\t\t\t\tthis.handleUsePlaybook();\n\t\t\t}\n\t\t},\n\t},\n\tcreated() {\n\t\tthis.$store\n\t\t\t.dispatch('campaigns/fetchRulesetData')\n\t\t\t.then((data) => {\n\t\t\t\tlet rules = data.rules;\n\n\t\t\t\trules.push(...data.bigCommerceRules);\n\t\t\t\trules.push(...data.eddRules);\n\t\t\t\trules.push(...data.shopifyRules);\n\t\t\t\trules.push(...data.wooCommerceRules);\n\n\t\t\t\tthis.setRules(rules);\n\t\t\t})\n\t\t\t.catch(() => {});\n\n\t\t// No filter options? Go get'em.\n\t\tif (!this.filterOptions.length) {\n\t\t\tthis.$store\n\t\t\t\t.dispatch('templates/fetchFilterOptions')\n\t\t\t\t.then((data) => {\n\t\t\t\t\tthis.setFilterOptions(data);\n\t\t\t\t})\n\t\t\t\t.catch(() => {});\n\t\t}\n\n\t\t// No Playbooks, get them too.\n\t\tif (!this.playbooks.length) {\n\t\t\tthis.$store\n\t\t\t\t.dispatch('playbooks/fetchPlaybooksData')\n\t\t\t\t.then(() => {\n\t\t\t\t\tif (this.$store.getters.connected) {\n\t\t\t\t\t\tthis.$store.dispatch('playbooks/fetchRecommendationsData').catch(() => {});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(() => {});\n\t\t}\n\n\t\tthis.setDismissedRecommendations();\n\n\t\tthis.loadApiScript(\n\t\t\t'omwpapi-playbooks-apijs',\n\t\t\tthis.$constants.PLAYBOOKS_PREVIEW_ACCOUNT,\n\t\t\tthis.$constants.PLAYBOOKS_PREVIEW_USER\n\t\t);\n\t},\n\tmethods: {\n\t\t...mapMutations('playbooks', ['setDismissedRecommendations', 'setRules', 'setFilterOptions', 'setUpgradeRule']),\n\t\t/**\n\t\t * Handle clicking the 'Use Playbook' button.\n\t\t *\n\t\t * @returns {void}\n\t\t */\n\t\thandleUsePlaybook() {\n\t\t\tthis.$store.commit('templates/setActiveTemplate', this.selectedPlaybook);\n\n\t\t\tif (!this.$store.getters.connected) {\n\t\t\t\treturn this.$modal.show('not-connected');\n\t\t\t}\n\n\t\t\tif (this.unavailableRules.length) {\n\t\t\t\tconst rule = ['exit-intent', 'inactivity-time'].find((rule) => this.unavailableRules.includes(rule));\n\n\t\t\t\tif (rule) {\n\t\t\t\t\tthis.setUpgradeRule(rule);\n\t\t\t\t}\n\t\t\t\treturn this.$modal.show('upgrade-modal');\n\t\t\t}\n\n\t\t\tthis.$modal.show('create-campaign-modal');\n\t\t},\n\t},\n};\n</script>\n<style lang=\"scss\">\n@import '../assets/scss/pages/playbooks.scss';\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Playbooks.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Playbooks.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Playbooks.vue?vue&type=template&id=12e1a0f1&\"\nimport script from \"./Playbooks.vue?vue&type=script&lang=js&\"\nexport * from \"./Playbooks.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Playbooks.vue?vue&type=style&index=0&id=12e1a0f1&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Playbooks.vue?vue&type=style&index=0&id=12e1a0f1&prod&lang=scss&\"","export const creation = {\n\tdata() {\n\t\treturn {\n\t\t\ttabs: {\n\t\t\t\ttemplates: {\n\t\t\t\t\tname: 'Templates',\n\t\t\t\t\troute: {\n\t\t\t\t\t\tpath: 'templates',\n\t\t\t\t\t\tparams: { tab: 'popup' },\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tplaybooks: {\n\t\t\t\t\tname: 'Playbooks',\n\t\t\t\t\troute: {\n\t\t\t\t\t\tpath: 'playbooks',\n\t\t\t\t\t\tparams: {},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t},\n};\n"],"sourceRoot":""}